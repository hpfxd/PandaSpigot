From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: uRyanxD <familiarodrigues123ro@gmail.com>
Date: Tue, 21 Oct 2025 15:42:06 -0300
Subject: [PATCH] Fix some commands not sending feedback to the player


diff --git a/src/main/java/org/bukkit/craftbukkit/command/VanillaCommandWrapper.java b/src/main/java/org/bukkit/craftbukkit/command/VanillaCommandWrapper.java
index db46eb055ff915525515068d53d58d68ad4009b6..2644e822907e7221aead33636e2e0dd5c3453b62 100644
--- a/src/main/java/org/bukkit/craftbukkit/command/VanillaCommandWrapper.java
+++ b/src/main/java/org/bukkit/craftbukkit/command/VanillaCommandWrapper.java
@@ -29,10 +29,10 @@ public final class VanillaCommandWrapper extends VanillaCommand {
     }
 
     public VanillaCommandWrapper(CommandAbstract vanillaCommand, String usage) {
-        super(vanillaCommand.getCommand());
+        // PandaSpigot start - Fix some vanilla command aliases not being registered
+        super(vanillaCommand.getCommand(), "A Mojang provided command.", usage, vanillaCommand.b());
         this.vanillaCommand = vanillaCommand;
-        this.description = "A Mojang provided command.";
-        this.usageMessage = usage;
+        // PandaSpigot end
         this.setPermission("minecraft.command." + vanillaCommand.getCommand());
     }
 
@@ -112,7 +112,11 @@ public final class VanillaCommandWrapper extends VanillaCommand {
                             chatmessage.getChatModifier().setColor(EnumChatFormat.RED);
                             icommandlistener.sendMessage(chatmessage);
                         } catch (CommandException commandexception) {
-                            CommandAbstract.a(icommandlistener, vanillaCommand, 1, commandexception.getMessage(), commandexception.getArgs());
+                            // PandaSpigot start - Fix some commands not sending feedback to the player, and the error message color not being red
+                            ChatMessage chatmessage = new ChatMessage(commandexception.getMessage(), commandexception.getArgs());
+                            chatmessage.getChatModifier().setColor(EnumChatFormat.RED);
+                            icommandlistener.sendMessage(chatmessage);
+                            // PandaSpigot end
                         } finally {
                             lastSender = oldSender;
                         }
@@ -133,7 +137,11 @@ public final class VanillaCommandWrapper extends VanillaCommand {
             chatmessage1.getChatModifier().setColor(EnumChatFormat.RED);
             icommandlistener.sendMessage(chatmessage1);
         } catch (CommandException commandexception) {
-            CommandAbstract.a(icommandlistener, vanillaCommand, 1, commandexception.getMessage(), commandexception.getArgs());
+            // PandaSpigot start - Fix some commands not sending feedback to the player, and the error message color not being red
+            ChatMessage chatmessage = new ChatMessage(commandexception.getMessage(), commandexception.getArgs());
+            chatmessage.getChatModifier().setColor(EnumChatFormat.RED);
+            icommandlistener.sendMessage(chatmessage);
+            // PandaSpigot end
         } catch (Throwable throwable) {
             ChatMessage chatmessage3 = new ChatMessage("commands.generic.exception", new Object[0]);
             chatmessage3.getChatModifier().setColor(EnumChatFormat.RED);
